"""
DES of the MAS. This DES is used to optimize certain aspects of the
MAS such as the bids. It can be used to quickly run multiple experiments.
The results can then be implemented in the MAS to see the effects.
"""
import itertools
import random
from collections import defaultdict


import numpy as np
import pandas as pd




# Machine information
machinesPerWC = [4, 2, 5, 3, 2]  # Number of machines per workcenter
machine_number_WC = [[1, 2, 3, 4], [5, 6], [7, 8, 9, 10, 11], [12, 13, 14], [15, 16]]  # Index of machines

# Central buffer information
noOfCbPerWC = [1, 1, 1, 1, 1]
central_buffers_cap_WC = [[1], [1], [1], [1], [1]]  # buffer cap per central buffer

# Number of Work Centers
noOfWC = range(len(machinesPerWC))





def choose_distance_matrix(AGV_selection, agvsPerWC_input):

    # 6 AGV per WC - ZERO TRAVEL TIME!
    if AGV_selection == 0:
        travel_time_matrix_static = {
            'depot': {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                      (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                      (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (2, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (3, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 1): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 1): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (2, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (3, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (4, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 3): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 3): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (2, 3): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 4): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 4): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (4, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0},
            (2, 1): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0},
            (5, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0},
            (3, 3): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0},
            (2, 4): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0}}
        agvsPerWC = [6, 6, 6, 6, 6]  # Number of AGVs per workcenter
        agv_number_WC = [[1, 2, 3, 4, 5, 6], [7, 8, 9, 10, 11, 12], [13, 14, 15, 16, 17, 18], [19, 20, 21, 22, 23, 24],
                         [25, 26, 27, 28, 29, 30]]  # Index of AGVs

    # Manual number - ZERO TRAVEL TIME!
    if AGV_selection == 1:
        travel_time_matrix_static = {
            'depot': {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                      (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                      (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (2, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (3, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 1): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 1): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (2, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (3, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (4, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 3): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 3): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (2, 3): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (0, 4): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (1, 4): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, (4, 0): 0, (2, 1): 0,
                     (5, 2): 0, (3, 3): 0, (2, 4): 0, 'depot': 0},
            (4, 0): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0},
            (2, 1): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0},
            (5, 2): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0},
            (3, 3): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0},
            (2, 4): {(0, 0): 0, (1, 0): 0, (2, 0): 0, (3, 0): 0, (0, 1): 0, (1, 1): 0, (0, 2): 0, (1, 2): 0, (2, 2): 0,
                     (3, 2): 0, (4, 2): 0, (0, 3): 0, (1, 3): 0, (2, 3): 0, (0, 4): 0, (1, 4): 0, 'depot': 0, (4, 0): 0,
                     (2, 1): 0, (5, 2): 0, (3, 3): 0, (2, 4): 0}}
        agvsPerWC = agvsPerWC_input  # Number of AGVs per workcenter
        agv_number_WC = []
        agv_count = 1
        for agv_WC in agvsPerWC:
            WC_AGV_list = []
            for No_agv_WC in range(agv_WC):
                WC_AGV_list.append(No_agv_WC + agv_count)
            agv_count += agv_WC
            agv_number_WC.append(WC_AGV_list)

    # Manual number
    if AGV_selection == 2:
        travel_time_matrix_static = {
            'depot': {(0, 0): 0.5759342851518146, (1, 0): 1.4557820556823677, (2, 0): 1.3959677502835937,
                      (3, 0): 0.8379133825334497, (0, 1): 1.3152955857191817, (1, 1): 1.1525776994483523,
                      (0, 2): 1.4015398027473727, (1, 2): 0.8492779627157023, (2, 2): 0.7950759859035929,
                      (3, 2): 1.183383686987614, (4, 2): 0.5098523858081664, (0, 3): 0.6871628605417575,
                      (1, 3): 0.6949720498691035, (2, 3): 0.5907782997346118, (0, 4): 0.5166727557849675,
                      (1, 4): 0.6748662371725741, 'depot': 0},
            (0, 0): {(0, 0): 0, (1, 0): 0.6184745828527917, (2, 0): 0.8678448436360923, (3, 0): 0.7974602280144814,
                     (0, 1): 1.1346300344463596, (1, 1): 1.0058821089504657, (0, 2): 0.6227273929303088,
                     (1, 2): 1.0001687140691509, (2, 2): 1.4797842543461672, (3, 2): 1.1114438043017842,
                     (4, 2): 1.2147288510804595, (0, 3): 1.4989445361966858, (1, 3): 0.5040363699299227,
                     (2, 3): 0.747003296930446, (0, 4): 0.7741688188036749, (1, 4): 1.1066164096178381,
                     (4, 0): 1.4159454315815556, (2, 1): 0.8134855868405468, (5, 2): 1.0202704886104046,
                     (3, 3): 0.5861607316550297, (2, 4): 0.9882183109374042, 'depot': 0.6811600058980787},
            (1, 0): {(0, 0): 1.4876810336722088, (1, 0): 0, (2, 0): 0.6140554175600785, (3, 0): 1.1522215890800682,
                     (0, 1): 0.9481411205241836, (1, 1): 0.594941889531579, (0, 2): 0.5459614719545225,
                     (1, 2): 0.5729881166790284, (2, 2): 0.696777416271452, (3, 2): 0.8368854408129723,
                     (4, 2): 1.25368449379633, (0, 3): 0.9532025814392859, (1, 3): 0.9114474815313529,
                     (2, 3): 1.4832921256405487, (0, 4): 1.3293501644873154, (1, 4): 0.8688918750821923,
                     (4, 0): 1.4884443986236031, (2, 1): 0.6682864304883821, (5, 2): 1.2531153976181248,
                     (3, 3): 1.0764253371631014, (2, 4): 0.5302205923325994, 'depot': 1.3687988338424772},
            (2, 0): {(0, 0): 0.7453801884288868, (1, 0): 0.8141502466433062, (2, 0): 0, (3, 0): 0.5711230956315084,
                     (0, 1): 1.1230967833846357, (1, 1): 1.412795158422551, (0, 2): 1.406028281960265,
                     (1, 2): 1.4662877949012878, (2, 2): 0.9545006544485005, (3, 2): 0.9640060120208166,
                     (4, 2): 0.6741797213598718, (0, 3): 1.4465406529472005, (1, 3): 0.6533451154630575,
                     (2, 3): 0.8156317274721566, (0, 4): 1.3680423606832015, (1, 4): 0.858347606858193,
                     (4, 0): 1.0011838007636351, (2, 1): 0.6937524622209116, (5, 2): 0.7386407711761424,
                     (3, 3): 0.5053508833051328, (2, 4): 1.2425119557660755, 'depot': 0.538689830681043},
            (3, 0): {(0, 0): 0.8710240573043144, (1, 0): 1.2786406313129968, (2, 0): 0.8387256587329485, (3, 0): 0,
                     (0, 1): 1.3994102280214256, (1, 1): 0.9243503503000928, (0, 2): 0.5202604850351905,
                     (1, 2): 1.2679703276014076, (2, 2): 0.5285325743971425, (3, 2): 0.8750814548364199,
                     (4, 2): 1.4126555235935618, (0, 3): 1.4999037986500467, (1, 3): 1.476905535513882,
                     (2, 3): 1.1862971224054766, (0, 4): 1.2747936026744933, (1, 4): 0.9311086296889257,
                     (4, 0): 1.1576184191510008, (2, 1): 0.8988487101690357, (5, 2): 0.9909640075476717,
                     (3, 3): 0.727833208213136, (2, 4): 0.5797828614472438, 'depot': 0.5948080201882457},
            (0, 1): {(0, 0): 1.1834888522393276, (1, 0): 0.8274363312910179, (2, 0): 1.0835030249299158,
                     (3, 0): 1.2855352471713557, (0, 1): 0, (1, 1): 1.201505702263242, (0, 2): 0.6073144028612398,
                     (1, 2): 1.0320561874992316, (2, 2): 1.1754423538765284, (3, 2): 1.1848025517060907,
                     (4, 2): 0.6553747012142642, (0, 3): 0.840580202349244, (1, 3): 0.6559451294486678,
                     (2, 3): 0.5903773995267431, (0, 4): 0.6070497518102047, (1, 4): 1.0205610525378488,
                     (4, 0): 0.622875380329042, (2, 1): 1.1839295245862012, (5, 2): 0.6858170324645432,
                     (3, 3): 0.8401526222644055, (2, 4): 0.7141471440076402, 'depot': 0.6595479372260648},
            (1, 1): {(0, 0): 0.7302478808316903, (1, 0): 1.4545190023941572, (2, 0): 0.6653042160978374,
                     (3, 0): 0.8201090309605406, (0, 1): 1.417447849810321, (1, 1): 0, (0, 2): 1.108242811771754,
                     (1, 2): 1.0081859724112343, (2, 2): 1.3433401549583022, (3, 2): 1.1316217670549658,
                     (4, 2): 0.589190330119444, (0, 3): 0.7582362936352546, (1, 3): 0.8996937255904466,
                     (2, 3): 1.3189267544896228, (0, 4): 1.0378748500713881, (1, 4): 0.5082552995366469,
                     (4, 0): 1.0447819040739232, (2, 1): 1.0617937564427007, (5, 2): 1.480789207783585,
                     (3, 3): 0.7629226455085508, (2, 4): 1.375157751460511, 'depot': 1.0164607892071391},
            (0, 2): {(0, 0): 1.3162576805349229, (1, 0): 1.102057857070966, (2, 0): 0.59149531032532,
                     (3, 0): 1.1666040347757876, (0, 1): 0.5690530470270468, (1, 1): 0.534734417626161, (0, 2): 0,
                     (1, 2): 1.2425932791127323, (2, 2): 0.8864338277478592, (3, 2): 1.2181830025853464,
                     (4, 2): 1.3428137023990623, (0, 3): 1.2662990219472856, (1, 3): 0.7679756588212165,
                     (2, 3): 0.98513507859875, (0, 4): 1.413773749880282, (1, 4): 0.6241634362519233,
                     (4, 0): 1.1513441233723192, (2, 1): 0.8623352512640687, (5, 2): 1.4834166166335994,
                     (3, 3): 0.722907629952039, (2, 4): 0.9031905274964189, 'depot': 0.6485637826375938},
            (1, 2): {(0, 0): 0.8476289182753012, (1, 0): 0.7433523287281842, (2, 0): 0.9509707746362762,
                     (3, 0): 1.2503129658186183, (0, 1): 0.9339185512491629, (1, 1): 1.48273897223768,
                     (0, 2): 0.6741367365080637, (1, 2): 0, (2, 2): 1.138981675045684, (3, 2): 1.2492896441618266,
                     (4, 2): 0.6460731397248516, (0, 3): 0.8287138961227752, (1, 3): 0.7402649187585033,
                     (2, 3): 1.0528140449793912, (0, 4): 1.4026850556314416, (1, 4): 0.9239339993842101,
                     (4, 0): 0.8291781265038576, (2, 1): 1.3456041857330514, (5, 2): 0.860652822308529,
                     (3, 3): 0.7966084923076744, (2, 4): 0.741994842950254, 'depot': 0.6271953358682982},
            (2, 2): {(0, 0): 0.7891887797756801, (1, 0): 0.535567187094372, (2, 0): 1.294419707087819,
                     (3, 0): 0.8499670634299309, (0, 1): 1.0049959306193879, (1, 1): 1.2173544439223967,
                     (0, 2): 1.0269012017782995, (1, 2): 1.47872669318772, (2, 2): 0, (3, 2): 0.674739661081244,
                     (4, 2): 0.8688052664576553, (0, 3): 1.0881028416044471, (1, 3): 1.0762760851834752,
                     (2, 3): 1.272956755229321, (0, 4): 1.2874488404106785, (1, 4): 1.398193681050341,
                     (4, 0): 0.6402952229525514, (2, 1): 1.2407755742970359, (5, 2): 0.5437228128962072,
                     (3, 3): 0.5827668961791854, (2, 4): 1.4427278591241377, 'depot': 1.194512050899441},
            (3, 2): {(0, 0): 1.1577542602354616, (1, 0): 1.2436901967398297, (2, 0): 1.3327502605564365,
                     (3, 0): 1.1129271929432663, (0, 1): 1.4161762469412245, (1, 1): 0.9984539889829197,
                     (0, 2): 0.5748338181823932, (1, 2): 0.7149906937821774, (2, 2): 1.4414781038073938, (3, 2): 0,
                     (4, 2): 0.8071157962035637, (0, 3): 0.6194052693300907, (1, 3): 1.491184341764773,
                     (2, 3): 0.816823635010673, (0, 4): 1.1312282713573039, (1, 4): 1.3859537159687711,
                     (4, 0): 1.4233737063353715, (2, 1): 1.4184031027995816, (5, 2): 1.1259226707918288,
                     (3, 3): 0.6451171289315476, (2, 4): 1.2167269618260312, 'depot': 1.116493865306456},
            (4, 2): {(0, 0): 1.0427329075081144, (1, 0): 0.5872236614238969, (2, 0): 1.4856856366246385,
                     (3, 0): 0.9803760753243923, (0, 1): 1.0668088818284351, (1, 1): 1.2417268827561196,
                     (0, 2): 0.7457054297563205, (1, 2): 0.8782191093662374, (2, 2): 0.6754442970511316,
                     (3, 2): 0.9186534741991431, (4, 2): 0, (0, 3): 0.9308282745987249, (1, 3): 0.5582809770554809,
                     (2, 3): 1.0522254577610437, (0, 4): 0.8392083536486263, (1, 4): 0.8029578238529591,
                     (4, 0): 1.1388599617914552, (2, 1): 1.3696704532591437, (5, 2): 0.5061809480246587,
                     (3, 3): 0.7051233465314259, (2, 4): 0.8619200481874058, 'depot': 1.3695581450906957},
            (0, 3): {(0, 0): 0.5206378286506259, (1, 0): 0.67412791150096, (2, 0): 0.5998743578235282,
                     (3, 0): 1.470580679924893, (0, 1): 1.2643501059367106, (1, 1): 0.7104312286951835,
                     (0, 2): 1.4354860348423402, (1, 2): 0.5690510923312155, (2, 2): 1.230115637139002,
                     (3, 2): 0.7196664228358263, (4, 2): 1.438344945203258, (0, 3): 0, (1, 3): 0.6289020153285183,
                     (2, 3): 1.4757568559013976, (0, 4): 0.9625868017270618, (1, 4): 1.448460049181679,
                     (4, 0): 1.1730698524981344, (2, 1): 1.2733309808271873, (5, 2): 0.5889801445168257,
                     (3, 3): 0.9746721729006519, (2, 4): 0.6701367100792303, 'depot': 0.8663598996947298},
            (1, 3): {(0, 0): 0.8125181728864328, (1, 0): 0.8440309053264842, (2, 0): 1.023599824488095,
                     (3, 0): 1.371890135227959, (0, 1): 0.9856335529618129, (1, 1): 0.5559723891075888,
                     (0, 2): 0.7489335304684749, (1, 2): 1.0914102827064984, (2, 2): 1.193002499075212,
                     (3, 2): 1.2460444868038394, (4, 2): 1.1711106734329313, (0, 3): 0.5880218802779692, (1, 3): 0,
                     (2, 3): 1.4701760232432992, (0, 4): 1.4075126971564154, (1, 4): 0.7651548877501877,
                     (4, 0): 1.1075416537253773, (2, 1): 0.984983422267507, (5, 2): 1.2122353012201228,
                     (3, 3): 0.5670050363312276, (2, 4): 1.054077053423567, 'depot': 1.2220395710379597},
            (2, 3): {(0, 0): 0.9599116750287786, (1, 0): 0.8187648118377744, (2, 0): 0.7606340572396768,
                     (3, 0): 1.265557834941295, (0, 1): 1.4192168452897431, (1, 1): 0.7171264442684662,
                     (0, 2): 1.3621044975327763, (1, 2): 1.049264554492181, (2, 2): 1.3492232845656624,
                     (3, 2): 1.3175979898227816, (4, 2): 1.091933493520861, (0, 3): 1.243724812830897,
                     (1, 3): 1.2009257996087608, (2, 3): 0, (0, 4): 1.0512972549086346, (1, 4): 0.955187914015804,
                     (4, 0): 0.6608735182377362, (2, 1): 1.2829580607008726, (5, 2): 1.4326381599850233,
                     (3, 3): 0.7488106307164285, (2, 4): 1.117305757991557, 'depot': 0.7604796162239287},
            (0, 4): {(0, 0): 0.8708606451722786, (1, 0): 1.4397890045607236, (2, 0): 1.3689657376558855,
                     (3, 0): 0.5228845657067316, (0, 1): 1.354238936331455, (1, 1): 0.7823234571001444,
                     (0, 2): 1.3429946136075737, (1, 2): 1.0061383594527986, (2, 2): 0.6970589537629024,
                     (3, 2): 1.2910676749997685, (4, 2): 1.395697430991057, (0, 3): 1.3697385486159155,
                     (1, 3): 1.0996869114583272, (2, 3): 1.0184412461684837, (0, 4): 0, (1, 4): 1.4133126859630578,
                     (4, 0): 1.2015901321550162, (2, 1): 1.0662225464914283, (5, 2): 1.0995467066594082,
                     (3, 3): 1.461207853679034, (2, 4): 1.224195513897785, 'depot': 1.2239104261164935},
            (1, 4): {(0, 0): 1.1394837092197907, (1, 0): 1.341028868306783, (2, 0): 1.0872207486688144,
                     (3, 0): 0.7922214679181698, (0, 1): 0.8111504823092579, (1, 1): 1.4016151512605655,
                     (0, 2): 1.3849967034855526, (1, 2): 1.0890093104510288, (2, 2): 0.9123498608001837,
                     (3, 2): 1.137756553991291, (4, 2): 0.7288341633940099, (0, 3): 1.1997258806800777,
                     (1, 3): 0.7833367309328766, (2, 3): 1.380552000490978, (0, 4): 1.2468754481946351, (1, 4): 0,
                     (4, 0): 0.9386910063016201, (2, 1): 1.1458846614336915, (5, 2): 0.958537862411965,
                     (3, 3): 1.4025224247591348, (2, 4): 1.1941865384078167, 'depot': 0.5560374578814498}}

        agvsPerWC = agvsPerWC_input  # Number of AGVs per workcenter
        agv_number_WC = []
        agv_count = 1
        for agv_WC in agvsPerWC:
            WC_AGV_list = []
            for No_agv_WC in range(agv_WC):
                WC_AGV_list.append(No_agv_WC+agv_count)
            agv_count += agv_WC
            agv_number_WC.append(WC_AGV_list)

    return travel_time_matrix_static, agvsPerWC, agv_number_WC


def create_distance_matrix():
    """Creates distance matrix where distance can be requested by inputting:
    distance_maxtrix[actual location][destination]"""

    # All distances are in meters
    distance_matrix = {
        "depot": {(ii, jj): random.uniform(0.5, 1.5) for jj in noOfWC for ii in range(machinesPerWC[jj])}}

    distance_matrix["depot"].update({"depot": 0})

    for jj in noOfWC:
        for ii in range(machinesPerWC[jj]):
            distance_matrix[(ii, jj)] = {(ii, jj): random.uniform(0.5, 1.5) for jj in noOfWC for ii in
                                         range(machinesPerWC[jj])}

            distance_matrix[(ii, jj)].update(
                {(ii + machinesPerWC[jj], jj): random.uniform(0.5, 1.5) for jj in noOfWC for ii in range(noOfCbPerWC[jj])})

            distance_matrix[(ii, jj)].update({"depot": random.uniform(0.5, 1.5)})

            distance_matrix[ii, jj][ii, jj] = 0


    return distance_matrix

